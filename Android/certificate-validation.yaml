id: improper-certificate-validation

info:
  name: Improper Certificate Validation
  author: YoruYagami
  severity: medium
  description: |
    This template detects improper certificate validation in Android applications. The use of `Landroid/webkit/SslErrorHandler;->proceed()V` indicates that SSL/TLS errors are ignored, allowing the application to proceed with potentially insecure connections. This practice can expose the application to man-in-the-middle (MITM) attacks, where an attacker can intercept and manipulate the data transmitted between the client and server.

    Ignoring SSL/TLS errors undermines the security guarantees provided by HTTPS and can lead to the exposure of sensitive user data. It is crucial to implement proper certificate validation to ensure the integrity and confidentiality of the data being transmitted.
  remediation: |
    To remediate this issue, implement proper certificate validation in your application. Instead of ignoring SSL/TLS errors, handle them appropriately by informing the user or terminating the connection. Here are some recommendations:

    1. Do not use `SslErrorHandler.proceed()` to bypass SSL/TLS errors.
    2. Use `SslErrorHandler.cancel()` to terminate connections with SSL/TLS errors.
    3. Implement custom SSL certificate validation if necessary, but ensure it adheres to security best practices.
    4. Regularly update and review your application's security policies related to SSL/TLS connections.

    Example of proper SSL/TLS error handling:

    ```java
    webView.setWebViewClient(new WebViewClient() {
        @Override
        public void onReceivedSslError(WebView view, SslErrorHandler handler, SslError error) {
            // Notify the user about the SSL error
            handler.cancel(); // Do not proceed with the insecure connection
        }
    });
    ```

file:
  - extensions:
      - all

    matchers:
      - type: word
        words:
          - "Landroid/webkit/SslErrorHandler;->proceed()V"
